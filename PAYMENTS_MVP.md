# Payments MVP: –ú–æ–¥–µ–ª—å –±–µ–∑ Escrow

## –ü—Ä–æ–±–ª–µ–º–∞

**Escrow (—Ö–æ–ª–¥ –ø–ª–∞—Ç–µ–∂–µ–π) —Ç—Ä–µ–±—É–µ—Ç:**
- –õ–∏—Ü–µ–Ω–∑–∏—é –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞ –¶–ë –†–§: **3.5 –º–ª–Ω ‚ÇΩ** + —É—Å—Ç–∞–≤–Ω–æ–π –∫–∞–ø–∏—Ç–∞–ª
- Compliance, –∞—É–¥–∏—Ç, –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–æ–º –¥–ª—è —Ö–æ–ª–¥–æ–≤
- **–ù–µ—Ä–µ–∞–ª—å–Ω–æ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø–∞ –Ω–∞ MVP**

## –†–µ—à–µ–Ω–∏–µ: Pay-After-Completion —Å –∑–∞—â–∏—Ç–æ–π

–ú–æ–¥–µ–ª—å **"–æ–ø–ª–∞—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è"** —Å –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ –¥–æ–≤–µ—Ä–∏—è –≤–º–µ—Å—Ç–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –≥–∞—Ä–∞–Ω—Ç–∏–π.

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. Client —Å–æ–∑–¥–∞–µ—Ç —Å–º–µ–Ω—É

**–°—Ç–∞—Ç—É—Å —Å–º–µ–Ω—ã:** `draft` ‚Üí `open`

**–î–µ–π—Å—Ç–≤–∏–µ:**
```typescript
// ‚ùå –ù–ï–¢ —Ö–æ–ª–¥–∞/–ø—Ä–µ–¥–æ–ø–ª–∞—Ç—ã
// ‚úÖ Client –ø—Ä–æ—Å—Ç–æ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–º–µ–Ω—É

await createShift({
  title: '...',
  total_amount: 8000, // –£–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤ –∑–∞–ø–ª–∞—Ç–∏—Ç—å
  status: 'open'
})
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–º–µ–Ω–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞
- Workers –≤–∏–¥—è—Ç –µ—ë –∏ –æ—Ç–∫–ª–∏–∫–∞—é—Ç—Å—è
- **–ù–ï–¢ –Ω–∏–∫–∞–∫–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ**

---

### 2. Worker –≤—ã–±—Ä–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°—Ç–∞—Ç—É—Å —Å–º–µ–Ω—ã:** `open` ‚Üí `in_progress` ‚Üí `completed`

**–î–µ–π—Å—Ç–≤–∏–µ:**
- Worker check-in ‚Üí —Å–º–µ–Ω–∞ –Ω–∞—á–∞–ª–∞—Å—å
- Worker check-out ‚Üí —Å–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- **–ù–ï–¢ –Ω–∏–∫–∞–∫–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ**
- –°–∏—Å—Ç–µ–º–∞ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ñ–∞–∫—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

### 3. Client –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ü–û–°–õ–ï –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** `completed` ‚Üí —Ç—Ä–∏–≥–≥–µ—Ä –æ–ø–ª–∞—Ç—ã

**–î–µ–π—Å—Ç–≤–∏–µ:**
```typescript
// –ü–æ—Å–ª–µ check-out worker –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
// "–°–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –û–∂–∏–¥–∞–π –æ–ø–ª–∞—Ç—É –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞"

// Client –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
// "–°–º–µ–Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –û–ø–ª–∞—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤"

// Client –Ω–∞–∂–∏–º–∞–µ—Ç "–û–ø–ª–∞—Ç–∏—Ç—å"
await createPayment({
  shift_id,
  amount: shift.total_amount,
  status: 'pending'
})

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å—Å—ã–ª–∫—É –Æ–ö–∞—Å—Å—ã
const paymentUrl = await yukassa.createPayment({
  amount: shift.total_amount,
  capture: true, // ‚úÖ –°—Ä–∞–∑—É —Å–ø–∏—Å—ã–≤–∞–µ–º (–Ω–µ—Ç —Ö–æ–ª–¥–∞)
  description: `–û–ø–ª–∞—Ç–∞ —Å–º–µ–Ω—ã: ${shift.title}`
})

// –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É client
sendNotification(client, 'payment_link', { url: paymentUrl })
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Client –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ –∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç
- –î–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ —Å—á–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- Worker –ø–æ–ª—É—á–∞–µ—Ç –≤—ã–ø–ª–∞—Ç—É —á–µ—Ä–µ–∑ 2-3 –¥–Ω—è

---

## –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã (–≤–º–µ—Å—Ç–æ escrow)

### üõ°Ô∏è 1. Trust Score (—Ä–µ–ø—É—Ç–∞—Ü–∏—è)

**Client:**
```typescript
trust_score = 100
  - (unpaid_shifts * 30)        // –ù–µ –æ–ø–ª–∞—Ç–∏–ª —Å–º–µ–Ω—É = -30
  - (late_payments * 10)         // –û–ø–æ–∑–¥–∞–ª —Å –æ–ø–ª–∞—Ç–æ–π = -10
  - (disputes_lost * 20)         // –ü—Ä–æ–∏–≥—Ä–∞–ª —Å–ø–æ—Ä = -20
  + (paid_on_time * 5)           // –û–ø–ª–∞—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è = +5
```

**–î–µ–π—Å—Ç–≤–∏—è –ø–æ trust_score:**
- **< 50**: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ (—á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∞)
- **< 30**: –Ω–µ –º–æ–∂–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–º–µ–Ω—ã
- **0**: –±–∞–Ω

**Worker:**
```typescript
trust_score = 100
  - (no_shows * 20)
  - (disputes_lost * 15)
  + (completed_shifts * 2)
```

---

### üõ°Ô∏è 2. Payment Deadline (–¥–µ–¥–ª–∞–π–Ω –æ–ø–ª–∞—Ç—ã)

**–ü—Ä–∞–≤–∏–ª–æ:** Client –¥–æ–ª–∂–µ–Ω –æ–ø–ª–∞—Ç–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ **24 —á–∞—Å–æ–≤** –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–µ:**

```typescript
// Cron job –∫–∞–∂–¥—ã–π —á–∞—Å
async function checkOverduePayments() {
  const overdue = await getShifts({
    status: 'completed',
    payment_status: 'pending',
    completed_at: { lt: new Date(Date.now() - 24 * 60 * 60 * 1000) }
  })

  for (const shift of overdue) {
    // 1. –°–Ω–∏–∂–∞–µ–º trust_score
    await updateTrustScore(shift.client_id, -30)

    // 2. –£–≤–µ–¥–æ–º–ª—è–µ–º –∞–¥–º–∏–Ω–∞
    await notifyAdmin(`Overdue payment: ${shift.id}`)

    // 3. –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—É–±–ª–∏–∫–∞—Ü–∏—é –Ω–æ–≤—ã—Ö —Å–º–µ–Ω
    await updateClient(shift.client_id, { can_post_shifts: false })

    // 4. –£–≤–µ–¥–æ–º–ª—è–µ–º client (–∂–µ—Å—Ç–∫–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)
    await sendNotification(shift.client_id, 'payment_overdue', {
      shift_id: shift.id,
      penalty: '30 trust points',
      action: '–û–ø–ª–∞—Ç–∏ —Å–µ–π—á–∞—Å –∏–ª–∏ –∞–∫–∫–∞—É–Ω—Ç –±—É–¥–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω'
    })

    // 5. –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è worker (–µ—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ–Ω–¥ –≥–∞—Ä–∞–Ω—Ç–∏–π)
    if (guaranteeFundAvailable) {
      await payFromGuaranteeFund(shift.worker_id, shift.total_amount * 0.85)
    }
  }
}
```

---

### üõ°Ô∏è 3. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Client (–ø–µ—Ä–µ–¥ –ø–µ—Ä–≤–æ–π —Å–º–µ–Ω–æ–π)

**–î–ª—è –Ω–æ–≤—ã—Ö clients:**

```typescript
// –ü–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –ü–ï–†–í–û–ô —Å–º–µ–Ω—ã
async function verifyClient(client) {
  // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  if (!client.phone_verified) {
    throw new Error('Verify phone first')
  }

  // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–∞–Ω–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç –¥–æ–≤–µ—Ä–∏–µ)
  if (client.company_inn) {
    const innValid = await checkINN(client.company_inn)
    if (innValid) {
      client.trust_score += 20 // –ë–æ–Ω—É—Å –∑–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –∫–æ–º–ø–∞–Ω–∏—é
    }
  }

  // 3. –¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  // –ú–æ–∂–µ–º –ø–æ–ø—Ä–æ—Å–∏—Ç—å –æ–ø–ª–∞—Ç–∏—Ç—å —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫—É—é —Å—É–º–º—É (100‚ÇΩ) —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∫–∞—Ä—Ç–∞ —Ä–∞–±–æ—á–∞—è
  const testPayment = await yukassa.createPayment({
    amount: 100,
    description: '–¢–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—Ä—Ç—ã'
  })

  // –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∏–ª - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–Ω—å–≥–∏ —Å—Ä–∞–∑—É
  if (testPayment.status === 'succeeded') {
    await yukassa.refundPayment(testPayment.id, 100)
    client.payment_method_verified = true
  }
}
```

---

### üõ°Ô∏è 4. –ì–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Ñ–æ–Ω–¥ (–¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)

**–ò–¥–µ—è:** –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç 5% –æ—Ç –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ "—Ñ–æ–Ω–¥ –≥–∞—Ä–∞–Ω—Ç–∏–π".

```typescript
// –ü—Ä–∏ –∫–∞–∂–¥–æ–π –æ–ø–ª–∞—Ç–µ
async function handlePaymentSuccess(payment) {
  const platformFee = payment.amount * 0.15 // 15%
  const guaranteeFee = payment.amount * 0.05 // 5% –≤ —Ñ–æ–Ω–¥

  await updateGuaranteeFund({
    balance: guaranteeFund.balance + guaranteeFee
  })

  // Worker –ø–æ–ª—É—á–∞–µ—Ç: amount * 0.85 (100% - 15% platform fee)
  // –§–æ–Ω–¥ –ø–æ–ª—É—á–∞–µ—Ç: amount * 0.05
  // Platform –ø–æ–ª—É—á–∞–µ—Ç: amount * 0.10 (15% - 5%)
}

// –ï—Å–ª–∏ client –Ω–µ –æ–ø–ª–∞—Ç–∏–ª –≤ —Å—Ä–æ–∫ - –ø–ª–∞—Ç–∏–º –∏–∑ —Ñ–æ–Ω–¥–∞
async function compensateWorkerFromFund(shift) {
  const workerAmount = shift.total_amount * 0.85

  if (guaranteeFund.balance >= workerAmount) {
    await payoutWorker(shift.worker_id, workerAmount, 'guarantee_fund')
    guaranteeFund.balance -= workerAmount

    // –î–æ–ª–≥ –≤–∏—Å–∏—Ç –Ω–∞ client
    await createDebt(shift.client_id, shift.total_amount)
  }
}
```

**–ü–ª—é—Å—ã:**
- Workers –∑–∞—â–∏—â–µ–Ω—ã –¥–∞–∂–µ –µ—Å–ª–∏ client –Ω–µ –ø–ª–∞—Ç–∏—Ç
- –§–æ–Ω–¥ —Ä–∞—Å—Ç–µ—Ç –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏ (5% —Å –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏)
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç –¥–µ–Ω—å–≥–∏ (–¥–æ–ª–≥ –æ—Å—Ç–∞–µ—Ç—Å—è –∑–∞ client)

---

### üõ°Ô∏è 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä–±–∏—Ç—Ä–∞–∂

**–ï—Å–ª–∏ client –Ω–µ –ø–ª–∞—Ç–∏—Ç –∏–ª–∏ —Å–ø–æ—Ä–∏—Ç:**

```typescript
async function handlePaymentDispute(shift, reason) {
  // 1. –§—Ä–∏–∑–∏–º –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã (–±–ª–æ–∫–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Å–º–µ–Ω—ã)
  await updateUser(shift.client_id, { frozen: true })
  await updateUser(shift.worker_id, { frozen: true })

  // 2. –°–æ–∑–¥–∞–µ–º dispute
  const dispute = await createDispute({
    shift_id: shift.id,
    raised_by: shift.client_id,
    reason,
    status: 'under_review'
  })

  // 3. –ê–¥–º–∏–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç (check-in/out logs, —Ñ–æ—Ç–æ, –ø–µ—Ä–µ–ø–∏—Å–∫—É)
  // 4. –ê–¥–º–∏–Ω —Ä–µ–∑–æ–ª–≤–∏—Ç:

  if (resolution === 'worker_favor') {
    // Client –¥–æ–ª–∂–µ–Ω –æ–ø–ª–∞—Ç–∏—Ç—å + —à—Ç—Ä–∞—Ñ 20%
    await createPayment(shift.client_id, shift.total_amount * 1.2)
    await updateTrustScore(shift.client_id, -50)
  } else if (resolution === 'client_favor') {
    // Worker –ø–æ–ª—É—á–∞–µ—Ç 0, trust_score -30
    await updateTrustScore(shift.worker_id, -30)
  } else if (resolution === 'partial') {
    // 50/50
    await createPayment(shift.client_id, shift.total_amount * 0.5)
  }
}
```

---

## Workflow —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

### ‚ùå Escrow (–Ω–µ—Ä–µ–∞–ª—å–Ω–æ –¥–ª—è MVP)

```
1. Client —Å–æ–∑–¥–∞–µ—Ç —Å–º–µ–Ω—É
2. ‚úã Client –ø–ª–∞—Ç–∏—Ç –ó–ê–†–ê–ù–ï–ï (—Ö–æ–ª–¥ –Ω–∞ –∫–∞—Ä—Ç–µ)
3. Worker —Ä–∞–±–æ—Ç–∞–µ—Ç
4. Worker –∑–∞–≤–µ—Ä—à–∞–µ—Ç
5. –î–µ–Ω—å–≥–∏ —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏ –∏–¥—É—Ç worker
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢—Ä–µ–±—É–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é + —Å–ª–æ–∂–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

### ‚úÖ Pay-After —Å –∑–∞—â–∏—Ç–æ–π (MVP)

```
1. Client —Å–æ–∑–¥–∞–µ—Ç —Å–º–µ–Ω—É
2. ‚úÖ –ù–ï–¢ –Ω–∏–∫–∞–∫–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π (–Ω–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞)
3. Worker —Ä–∞–±–æ—Ç–∞–µ—Ç
4. Worker –∑–∞–≤–µ—Ä—à–∞–µ—Ç
5. ‚úã Client –¥–æ–ª–∂–µ–Ω –æ–ø–ª–∞—Ç–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 24—á
6. –ï—Å–ª–∏ –Ω–µ –ø–ª–∞—Ç–∏—Ç ‚Üí trust_score –ø–∞–¥–∞–µ—Ç ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ‚Üí –∞–¥–º–∏–Ω —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è
7. –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ–Ω–¥ –≥–∞—Ä–∞–Ω—Ç–∏–π ‚Üí worker –ø–æ–ª—É—á–∞–µ—Ç –¥–µ–Ω—å–≥–∏ –∏–∑ —Ñ–æ–Ω–¥–∞, –¥–æ–ª–≥ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ client
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Æ–ö–∞—Å—Å–æ–π
- ‚úÖ –ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ –¥–ª—è clients
- ‚úÖ Workers –∑–∞—â–∏—â–µ–Ω—ã trust score + —Ñ–æ–Ω–¥–æ–º

**–ú–∏–Ω—É—Å—ã:**
- ‚ö†Ô∏è –†–∏—Å–∫ –Ω–µ–æ–ø–ª–∞—Ç—ã (–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è trust score)
- ‚ö†Ô∏è –ù—É–∂–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –±—ã—Å—Ç—Ä–∞—è —Ä–µ–∞–∫—Ü–∏—è –∞–¥–º–∏–Ω–∞

---

## –ü–µ—Ä–µ—Ö–æ–¥ –∫ Escrow (–∫–æ–≥–¥–∞ –≤—ã—Ä–∞—Å—Ç–µ–º)

**–ö–æ–≥–¥–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤—ã—Ä–∞—Å—Ç–µ—Ç –¥–æ 1000+ —Å–º–µ–Ω/–º–µ—Å—è—Ü:**

1. **–°–æ–±–∏—Ä–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:**
   - –ö–∞–∫–æ–π % clients –Ω–µ –ø–ª–∞—Ç–∏—Ç –≤–æ–≤—Ä–µ–º—è?
   - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Ñ–æ–Ω–¥–∞ –≥–∞—Ä–∞–Ω—Ç–∏–π?
   - –°–∫–æ–ª—å–∫–æ sporov –∏ –∏—Ö —Ä–µ–∑–æ–ª—é—Ü–∏—è?

2. **–ü–æ–ª—É—á–∞–µ–º –ª–∏—Ü–µ–Ω–∑–∏—é (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
   - –û–±–æ—Ä–æ—Ç >100 –º–ª–Ω ‚ÇΩ/–≥–æ–¥
   - –ë–æ–ª–µ–µ 1% –Ω–µ–æ–ø–ª–∞—Ç
   - –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –∂–∞–ª–æ–±—ã workers

3. **–î–æ–±–∞–≤–ª—è–µ–º Escrow –∫–∞–∫ –æ–ø—Ü–∏—é:**
   - Client –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å: pay-after (–±–µ—Å–ø–ª–∞—Ç–Ω–æ) –∏–ª–∏ escrow (+3% –∫–æ–º–∏—Å—Å–∏—è –∑–∞ –≥–∞—Ä–∞–Ω—Ç–∏—é)
   - Verified clients (trust_score >90) –º–æ–≥—É—Ç pay-after
   - –ù–æ–≤—ã–µ clients - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π escrow

---

## Implementation Plan

### Phase 1: MVP (Pay-After) - Week 1-2

- [x] Payments table (status: pending/paid/overdue)
- [ ] Payment link generation (–Æ–ö–∞—Å—Å–∞)
- [ ] Payment deadline tracking (24h)
- [ ] Trust score calculation
- [ ] Overdue payments cron job
- [ ] Admin alerts for overdue

### Phase 2: Protection - Week 2-3

- [ ] Phone verification (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è clients)
- [ ] Company INN check (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] Test payment (100‚ÇΩ card check)
- [ ] Guarantee fund setup (5% fee)
- [ ] Auto-block for trust_score <30

### Phase 3: Operations - Week 3

- [ ] Dispute workflow (admin panel)
- [ ] Payout from guarantee fund
- [ ] Debt tracking (unpaid shifts)
- [ ] Client billing reminders (push/email)

---

## KPIs to Track

**Payment health:**
- Payment on-time rate: **>95%** (—Ü–µ–ª—å)
- Overdue payment rate: **<5%**
- Guarantee fund usage: **<2%** (—Ä–µ–¥–∫–æ –ø–ª–∞—Ç–∏–º –∏–∑ —Ñ–æ–Ω–¥–∞)

**Trust system:**
- Average trust_score: **>80**
- Blocked clients: **<3%**
- Dispute resolution time: **<24h**

---

## Risk Mitigation

### –ß—Ç–æ –µ—Å–ª–∏ client –º–∞—Å—Å–æ–≤–æ –Ω–µ –ø–ª–∞—Ç—è—Ç?

1. **Short-term:**
   - –ü–ª–∞—Ç–∏–º workers –∏–∑ —Ñ–æ–Ω–¥–∞ –≥–∞—Ä–∞–Ω—Ç–∏–π
   - –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö clients
   - –ê–¥–º–∏–Ω —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏—á–Ω–æ

2. **Long-term:**
   - –í–≤–æ–¥–∏–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É –¥–ª—è clients —Å trust_score <70
   - –ü–æ–≤—ã—à–∞–µ–º guarantee fund –¥–æ 7-10%
   - –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –ª–∏—Ü–µ–Ω–∑–∏–∏

### –ß—Ç–æ –µ—Å–ª–∏ —Ñ–æ–Ω–¥ –≥–∞—Ä–∞–Ω—Ç–∏–π –∫–æ–Ω—á–∏–ª—Å—è?

**–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –º–µ—Ä–∞:**
```typescript
if (guaranteeFund.balance < minThreshold) {
  // –í—Ä–µ–º–µ–Ω–Ω–æ –≤–∫–ª—é—á–∞–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é –ø—Ä–µ–¥–æ–ø–ª–∞—Ç—É –¥–ª—è –í–°–ï–• –Ω–æ–≤—ã—Ö —Å–º–µ–Ω
  await updatePlatformSettings({
    require_prepayment_for_all: true
  })

  // –£–≤–µ–¥–æ–º–ª—è–µ–º clients
  sendNotification('all_clients', 'prepayment_required', {
    reason: '–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ä–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã workers'
  })
}
```

---

## Conclusion

**–ú–æ–¥–µ–ª—å Pay-After-Completion:**
- ‚úÖ –ó–∞–∫–æ–Ω–Ω–∞ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é
- ‚úÖ –†–µ–∞–ª–∏–∑—É–µ–º–∞ –∑–∞ 1-2 –Ω–µ–¥–µ–ª–∏
- ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞ –¥–ª—è MVP (–ø–µ—Ä–≤—ã—Ö 500-1000 —Å–º–µ–Ω)
- ‚úÖ Workers –∑–∞—â–∏—â–µ–Ω—ã trust score + –≥–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–º —Ñ–æ–Ω–¥–æ–º
- ‚úÖ –ù–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞ –¥–ª—è clients

**–ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ Escrow:**
- –û–±–æ—Ä–æ—Ç >100 –º–ª–Ω ‚ÇΩ/–≥–æ–¥
- –ù–µ–æ–ø–ª–∞—Ç—ã >1%
- Workers —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –≥–∞—Ä–∞–Ω—Ç–∏–π

**–°–µ–π—á–∞—Å:** –§–æ–∫—É—Å –Ω–∞ trust score, –±—ã—Å—Ç—Ä—ã–π –∞—Ä–±–∏—Ç—Ä–∞–∂ –∏ –≥–∞—Ä–∞–Ω—Ç–∏–π–Ω—ã–π —Ñ–æ–Ω–¥. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤ —Ç–∏–ø–∞ Avito, Profi.ru, YouDo - –æ–Ω–∏ —Ç–æ–∂–µ –Ω–∞—á–∏–Ω–∞–ª–∏ –±–µ–∑ escrow.
